<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>VapoShop</title>
<style>
  body {
    margin: 0; font-family: Arial, sans-serif; background-color: #111; color: white;
  }
  header {
    text-align: center; padding: 20px 10px; background: #1e1e1e;
  }
  #productos {
    display: flex; flex-wrap: wrap; justify-content: center; padding: 20px;
  }
  .card {
    background: #1e1e1e; border-radius: 12px; margin: 16px; padding: 16px;
    width: 240px; box-shadow: 0 0 10px rgba(0,0,0,0.5);
    text-align: center; transition: transform 0.3s;
  }
  .card:hover {
    transform: scale(1.05);
  }
  .card img {
    width: 100%; border-radius: 8px;
  }
  .precio {
    color: #25D366; font-weight: bold;
  }
  .descripcion {
    font-size: 0.9em; color: #ccc; margin-top: 5px;
  }
  .btnComprar {
    display: inline-block; padding: 8px 16px; background: #25D366;
    color: white; text-decoration: none; border-radius: 6px; margin-top: 8px;
  }
  a.whatsapp {
    position: fixed; bottom: 20px; right: 20px; background: #25D366;
    padding: 12px 16px; border-radius: 50px; color: white; font-weight: bold;
    box-shadow: 0 0 10px #25D366; text-decoration: none;
  }
  /* Easter egg invisible */
  #admin-access {
    position: fixed; bottom: 5px; left: 5px; width: 30px; height: 30px; cursor: pointer;
  }
</style>
</head>
<body>

<header>
  <h1>VapeDealer MX</h1>
  <p>No vendemos humo. Vendemos estilo ðŸ’¨</p>
</header>

<div id="productos"></div>

<a href="https://wa.me/5213346799345" target="_blank" class="whatsapp">ðŸ’¬ WhatsApp</a>

<div id="admin-access"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";
  import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBJZPTFlDus1LOHkWfavrgy8S-x7xpmzdI",
    authDomain: "vapedealerstore.firebaseapp.com",
    projectId: "vapedealerstore",
    storageBucket: "vapedealerstore.appspot.com",
    messagingSenderId: "669843415263",
    appId: "1:669843415263:web:27c57bdfa10606e180096a"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const storage = getStorage(app);

  const contenedor = document.getElementById("productos");

  async function cargarProductos() {
    contenedor.innerHTML = "";
    const querySnapshot = await getDocs(collection(db, "productos"));

    for (const doc of querySnapshot.docs) {
      const p = doc.data();
      // Obtener URL real de la imagen en Storage
      let urlImg = p.imagen;
      try {
        urlImg = await getDownloadURL(ref(storage, p.imagen));
      } catch {
        // Si no encuentra la imagen, usa url que venga o un placeholder
      }

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <img src="${urlImg}" alt="${p.nombre}">
        <h3>${p.nombre}</h3>
        <p class="precio">${p.precio}</p>
        <p class="descripcion">${p.descripcion || ""}</p>
        <a href="https://wa.me/5213346799345?text=Hola! Estoy interesado en el ${encodeURIComponent(p.nombre)}" target="_blank" class="btnComprar">Comprar ðŸ’¨</a>
      `;
      contenedor.appendChild(card);
    }
  }

  cargarProductos();

  // Easter egg para admin: 5 clicks en esquina inferior izquierda
  const adminAccess = document.getElementById("admin-access");
  let clicks = 0;
  adminAccess.addEventListener("click", () => {
    clicks++;
    if(clicks >= 5) window.location.href = "admin.html";
  });
</script>

</body>
</html>
